
CMAKE_MINIMUM_REQUIRED(VERSION 2.6)
PROJECT( MEDV4D_TOOLS )

IF(NOT CMAKE_BUILD_TYPE)
  SET(CMAKE_BUILD_TYPE Debug CACHE STRING
      "Choose the type of build, options are: None Debug Release RelWithDebInfo MinSizeRel."
      FORCE)
ENDIF(NOT CMAKE_BUILD_TYPE)

IF(NOT MEDV4D_CMAKE_SOURCE_DIR)
	SET(MEDV4D_CMAKE_SOURCE_DIR "${CMAKE_SOURCE_DIR}/../.." )
	SET(MEDV4D_CMAKE_MODULES_DIR ${MEDV4D_CMAKE_SOURCE_DIR}/Modules)
	SET(CMAKE_MODULE_PATH "${MEDV4D_CMAKE_MODULES_DIR}" "${CMAKE_ROOT}/Modules" )
ENDIF(NOT MEDV4D_CMAKE_SOURCE_DIR)

INCLUDE( "${MEDV4D_CMAKE_MODULES_DIR}/Functions.cmake" )
INCLUDE( "${MEDV4D_CMAKE_MODULES_DIR}/FindPackages.cmake" )
INCLUDE( "${MEDV4D_CMAKE_MODULES_DIR}/StandardCompileOptions.cmake" )

#FIND_PACKAGE( DevIL COMPONENTS "IL" )

#Mandatory -- prevents adding targets for Medv4DLibs more than once 
IF(NOT MEDV4D_LIBS_CMAKE_PROCESSED)
	ADD_SUBDIRECTORY( "${MEDV4D_CMAKE_SOURCE_DIR}/Medv4DLibs" "${MEDV4D_CMAKE_SOURCE_DIR}/../tmp" )
	#Must propagate to parent scope
	SET( MEDV4D_LIBS_CMAKE_PROCESSED TRUE PARENT_SCOPE)
ENDIF(NOT MEDV4D_LIBS_CMAKE_PROCESSED)

ADD_DEFINITIONS( ${MEDV4D_COMPILE_DEFINITIONS} )

MESSAGE( "+++++${MEDV4D_ALL_LIBRARIES}" )


SET(EXECUTABLE_OUTPUT_PATH ${MEDV4D_CMAKE_SOURCE_DIR}/../executables/tools)

SET(TOOLS_SRC_DIR "${MEDV4D_CMAKE_SOURCE_DIR}/../Applications/tools")

ADD_EXECUTABLE(CannyEdgeDetector ${TOOLS_SRC_DIR}/CannyEdgeDetector.cpp)
TARGET_LINK_LIBRARIES(CannyEdgeDetector ${MEDV4D_ALL_LIBRARIES})
ADD_DEPENDENCIES(CannyEdgeDetector ${MEDV4D_LIB_TARGETS})

ADD_EXECUTABLE(ClampFilter ${TOOLS_SRC_DIR}/ClampFilter.cpp)
TARGET_LINK_LIBRARIES(ClampFilter ${MEDV4D_ALL_LIBRARIES})
ADD_DEPENDENCIES(ClampFilter ${MEDV4D_LIB_TARGETS})

ADD_EXECUTABLE(CreateExampleData ${TOOLS_SRC_DIR}/CreateExampleData.cpp)
TARGET_LINK_LIBRARIES(CreateExampleData ${MEDV4D_ALL_LIBRARIES})
ADD_DEPENDENCIES(CreateExampleData ${MEDV4D_LIB_TARGETS})

ADD_EXECUTABLE(DICOM2ImageDump ${TOOLS_SRC_DIR}/DICOM2ImageDump.cpp)
TARGET_LINK_LIBRARIES(DICOM2ImageDump ${MEDV4D_ALL_LIBRARIES})
ADD_DEPENDENCIES(DICOM2ImageDump ${MEDV4D_LIB_TARGETS})

ADD_EXECUTABLE(GaussianFilter ${TOOLS_SRC_DIR}/GaussianFilter.cpp)
TARGET_LINK_LIBRARIES(GaussianFilter ${MEDV4D_ALL_LIBRARIES})
ADD_DEPENDENCIES(GaussianFilter ${MEDV4D_LIB_TARGETS})

ADD_EXECUTABLE(ImageCrop ${TOOLS_SRC_DIR}/ImageCrop.cpp)
TARGET_LINK_LIBRARIES(ImageCrop ${MEDV4D_ALL_LIBRARIES})
ADD_DEPENDENCIES(ImageCrop ${MEDV4D_LIB_TARGETS})

ADD_EXECUTABLE(ImageDumpView ${TOOLS_SRC_DIR}/ImageDumpView.cpp)
ADD_DEPENDENCIES(ImageDumpView ${MEDV4D_LIB_TARGETS})
TARGET_LINK_LIBRARIES(ImageDumpView ${MEDV4D_ALL_LIBRARIES})

ADD_EXECUTABLE(LaplaceOperator ${TOOLS_SRC_DIR}/LaplaceOperator.cpp)
ADD_DEPENDENCIES(LaplaceOperator ${MEDV4D_LIB_TARGETS})
TARGET_LINK_LIBRARIES(LaplaceOperator ${MEDV4D_ALL_LIBRARIES})

ADD_EXECUTABLE(MaxFilter ${TOOLS_SRC_DIR}/MaxFilter.cpp)
ADD_DEPENDENCIES(MaxFilter ${MEDV4D_LIB_TARGETS})
TARGET_LINK_LIBRARIES(MaxFilter ${MEDV4D_ALL_LIBRARIES})

ADD_EXECUTABLE(MedianFilter ${TOOLS_SRC_DIR}/MedianFilter.cpp)
ADD_DEPENDENCIES(MedianFilter ${MEDV4D_LIB_TARGETS})
TARGET_LINK_LIBRARIES(MedianFilter ${MEDV4D_ALL_LIBRARIES})

ADD_EXECUTABLE(MinFilter ${TOOLS_SRC_DIR}/MinFilter.cpp)
ADD_DEPENDENCIES(MinFilter ${MEDV4D_LIB_TARGETS})
TARGET_LINK_LIBRARIES(MinFilter ${MEDV4D_ALL_LIBRARIES})

ADD_EXECUTABLE(SaveModelVisualization ${TOOLS_SRC_DIR}/SaveModelVisualization.cpp)
ADD_DEPENDENCIES(SaveModelVisualization ${MEDV4D_LIB_TARGETS})
TARGET_LINK_LIBRARIES(SaveModelVisualization ${MEDV4D_ALL_LIBRARIES})

ADD_EXECUTABLE(SobelEdgeDetector ${TOOLS_SRC_DIR}/SobelEdgeDetector.cpp)
ADD_DEPENDENCIES(SobelEdgeDetector ${MEDV4D_LIB_TARGETS})
TARGET_LINK_LIBRARIES(SobelEdgeDetector ${MEDV4D_ALL_LIBRARIES})

ADD_EXECUTABLE(SobelGradientOperator ${TOOLS_SRC_DIR}/SobelGradientOperator.cpp)
TARGET_LINK_LIBRARIES(SobelGradientOperator ${MEDV4D_ALL_LIBRARIES})
ADD_DEPENDENCIES(SobelGradientOperator ${MEDV4D_LIB_TARGETS})


IF( DEVIL_FOUND )
	ADD_EXECUTABLE(ImageDump2Picture ${TOOLS_SRC_DIR}/ImageDump2Picture.cpp)
	ADD_DEPENDENCIES(ImageDump2Picture ${MEDV4D_LIB_TARGETS})
	TARGET_LINK_LIBRARIES(ImageDump2Picture ${MEDV4D_ALL_LIBRARIES} ${DEVIL_LIBRARIES})
ENDIF( DEVIL_FOUND )

